
---
title: 草稿大全
date: 1997-04-10
---

### 优化

#### 帧率

尤其对Unity这种太多逻辑绑在主线程的引擎而言，需要尽量不卡主线程：分帧，多线程（job），调整tick频率等等。

图形相关优化：控制drawcall，shader优化，overdraw优化，culling...



#### 内存

整体上，对于内存比较吃紧的机器来说是：

* 不用的就不加载，晚点用的就晚点加载（按需加载），能确定不用的就卸载。
* 需要加载的能不能降低质量：例如资源能不能做压缩（贴图压缩，animation、mesh能不能做16bit的压缩）、高低配等。
* 数据结构上的调整：例如容器数据结构能不能调优一下、扩容的参数能不能调整，如果有大量string能不能做前缀压缩等。

另一方面，32位机器除了内存占用本身以外，还要考虑虚拟内存的占用，优化这个需要一些来自安卓的专家帮忙，看下smaps的分布再进行针对性优化。



#### 卡顿

削峰填谷，非常业务向的优化

* 针对加载的卡顿：预加载、异步加载（按优先级分）、cache复用
* GC：高内存关gc，要GC的话则在感知不强的地方手动GC
* 分帧
* case by case：shader编译的卡顿则考虑prewarm，其他的具体问题具体分析



#### 启动时间

“能不做的就不做，一定要做的能不能少做、慢慢做、晚点做”

读取配置，异步/多线程 + 懒加载 + 二进制化，或者直接加进打包流程做进代码里。



#### 包体

压缩：zstd

分包，高清包

定期diff包体资源列表



### 渲染优化





### 超低端机优化

1G内存手机，定好目标：玩X局不crash。因此，内存需要优化到极限，即使以帧率和卡顿为代价。另外超低端机一般存储空间也极为有限，网速也不好，所以最小可玩包体要控制到很小。


